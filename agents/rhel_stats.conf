# Telegraf Configuration for RHEL System Metrics
# Collects system update and time synchronization metrics
# Designed by Ifesinachi Osude

###############################################################################
# DNF Last Update Metrics
###############################################################################
[[inputs.exec]]
  ## Commands to run
  commands = ["/usr/local/bin/dnf_last_update"]
  
  ## Timeout for command execution
  timeout = "30s"
  
  ## Data format (prometheus for these collectors)
  data_format = "prometheus"
  
  ## Metric name prefix (optional)
  name_prefix = "rhel_"
  
  ## Interval (how often to run - adjust as needed)
  interval = "5m"

###############################################################################
# DNF Update Check Metrics
###############################################################################
[[inputs.exec]]
  ## Commands to run
  commands = ["/usr/local/bin/dnf_update_check"]
  
  ## Timeout for command execution (this can take longer)
  timeout = "2m"
  
  ## Data format
  data_format = "prometheus"
  
  ## Metric name prefix (optional)
  name_prefix = "rhel_"
  
  ## Interval (check for updates every 15 minutes)
  interval = "15m"

###############################################################################
# Chrony Sources Metrics
###############################################################################
[[inputs.exec]]
  ## Commands to run
  commands = ["/usr/local/bin/chrony_sources"]
  
  ## Timeout for command execution
  timeout = "10s"
  
  ## Data format
  data_format = "prometheus"
  
  ## Metric name prefix (optional)
  name_prefix = "rhel_"
  
  ## Interval (check time sync every minute)
  interval = "1m"

###############################################################################
# Notes:
# - Ensure binaries are installed in /usr/local/bin/ or update paths above
# - Adjust intervals based on your monitoring needs
# - These metrics are exposed via Telegraf's Prometheus output
# - Requires Telegraf with Prometheus output plugin enabled
#
# Version: 1.0.0
# Designed by Ifesinachi Osude
###############################################################################
